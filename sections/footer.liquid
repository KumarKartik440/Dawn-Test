{% comment %}theme-check-disable UndefinedObject{% endcomment %}
{{ 'section-footer.css' | asset_url | stylesheet_tag }}
{{ 'component-newsletter.css' | asset_url | stylesheet_tag }}
{{ 'component-list-menu.css' | asset_url | stylesheet_tag }}
{{ 'component-list-payment.css' | asset_url | stylesheet_tag }}
{{ 'component-list-social.css' | asset_url | stylesheet_tag }}

{%- style -%}
  :root{
    --footer-accent: #4a2baa;          /* Your preferred accent */
    --footer-bg: #0e0f13;
    --footer-card: #16181f;
    --footer-muted: #9aa0ae;
    --footer-ring: rgba(74,43,170,.25);
    --footer-radius: 16px;
  }

  .footer {
    margin-top: {{ section.settings.margin_top | times: 0.75 | round: 0 }}px;
    background: var(--footer-bg);
    color: #fff;
  }
  .footer a { color: #fff; text-decoration: none; }
  .footer a:hover { color: #ffea3a; }

  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  /* ——— Top: Newsletter Card ——— */
  .ft-newsletter-card{
    position: relative;
    border-radius: var(--footer-radius);
    padding: 28px 22px;
    background:
      radial-gradient(1200px 400px at -10% -30%, rgba(74,43,170,.35), transparent 55%),
      linear-gradient(180deg, var(--footer-card), rgba(255, 255, 255, 0.92));
    box-shadow: 0 12px 30px rgba(0,0,0,.35), 0 0 0 1px var(--footer-ring) inset;
    overflow: hidden;
  }
  .ft-newsletter-grid{
    display: grid;
    grid-template-columns: 1.6fr 1fr;
    gap: 20px;
    align-items: center;
  }
  .ft-newsletter-title{
    font-weight: 800; letter-spacing:.02em;
    font-size: clamp(1.35rem, 1.1vw + 1.1rem, 1.8rem);
    margin: 0 0 4px;
  }
  .ft-newsletter-copy{ color: var(--footer-muted); margin: 0 0 14px; }

  .newsletter-form .field{
    background: #0f1117;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
  }
  .newsletter-form .field__input{
    background: transparent; color:#fff;
    padding: 14px 16px 14px 16px;
  }
  .newsletter-form__button{
    background: #ffea3a; color:#000; font-weight:700;
    border-radius: 10px; margin-right: 6px;
  }
  .newsletter-form__button:hover{ transform: translateY(-1px); }

  .footer__list-social{
    margin-top: 14px;
    gap: 10px;
  }
  .footer__list-social .list-social__link{
    width:40px; height:40px; border-radius: 10px;
    background:#0f1117; display:grid; place-items:center;
    box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
  }
  .footer__list-social .list-social__link:hover{
    box-shadow: 0 0 0 1px #ffea3a inset; transform: translateY(-1px);
  }

  /* ——— Middle: Link Columns / Blocks ——— */
  .footer__content-top{ margin-top: 28px; }
  .footer__blocks-wrapper{
    display: grid;
    gap: 26px;
  }

  /* Mobile collapsible headings */
  .footer-block{
    background: var(--footer-card);
    border-radius: 14px;
    box-shadow: 0 0 0 1px rgba(255,255,255,.06) inset;
    padding: 14px 16px;
  }
  .footer-block__heading{
    display:flex; justify-content:space-between; align-items:center;
    font-size: 1.05rem; margin: 0;
  }
  .ft-caret{
    transition: transform .25s ease;
  }
  details[open] > summary .ft-caret{ transform: rotate(180deg); }
  .footer-block__details-content{
    margin-top: 10px;
  }
  .footer-block__details-content a{
    color: var(--footer-muted);
  }
  .footer-block__details-content a:hover{
    color:#fff;
  }

  /* ——— Bottom: Localization / Payments / Policies ——— */
  .footer__content-bottom{
    margin-top: 28px;
    padding-top: 18px;
    border-top: 1px solid rgba(255,255,255,.08);
  }
  .footer__content-bottom-wrapper{
    display: grid; gap: 18px;
    align-items: center;
  }
  .footer__payment .list-payment{ justify-content: flex-start; gap: 8px; }
  .footer__copyright{
    display:flex; flex-wrap:wrap; gap:10px; align-items:center;
    color: var(--footer-muted);
  }
  .policies{ display:flex; gap:12px; flex-wrap:wrap; }

  /* ——— Back to Top ——— */
  .ft-backtop{
    position: fixed; right: 16px; bottom: 20px; z-index: 50;
    width:46px; height:46px; border-radius:12px;
    background: #ffea3a; color:#000; display:grid; place-items:center;
    box-shadow: 0 8px 20px rgba(0,0,0,.35);
    cursor:pointer; transition: transform .2s ease, opacity .2s ease;
    opacity: 0; pointer-events: none;
  }
  .ft-backtop.show{ opacity: 1; pointer-events: auto; }
  .ft-backtop:hover{ transform: translateY(-2px); }

  /* ——— Responsive ——— */
  @media screen and (min-width: 750px) {
    .footer { margin-top: {{ section.settings.margin_top }}px; }
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
    .footer__blocks-wrapper{
      grid-template-columns: repeat(12, 1fr);
    }
    /* Allow up to 4 blocks in a row with nice spans */
    .footer-block.grid__item{ grid-column: span 6; }
    .grid--4-col-tablet .footer-block.grid__item{ grid-column: span 3; }
    .grid--3-col-tablet .footer-block.grid__item{ grid-column: span 4; }

    .footer-block{ padding: 18px 20px; }
    .footer__content-bottom-wrapper{
      grid-template-columns: 1fr auto;
    }
  }
  @media (min-width: 990px){
    .ft-newsletter-card{ padding: 34px 28px; }
    .ft-newsletter-grid{ gap: 28px; }
  }
{%- endstyle -%}

<footer class="footer color-{{ section.settings.color_scheme }} section-{{ section.id }}-padding">
  <div class="page-width">
    <!-- Newsletter / Social Card -->
    <div class="ft-newsletter-card">
      <div class="ft-newsletter-grid">
        <div>
          <h2 class="ft-newsletter-title">
            {{ section.settings.newsletter_heading | default: 'Get first access to new drops & offers' }}
          </h2>
          <p class="ft-newsletter-copy">Join our list for insider perks. Unsubscribe anytime.</p>

          {%- if section.settings.newsletter_enable -%}
            {%- form 'customer', id: 'ContactFooter', class: 'footer__newsletter newsletter-form' -%}
              <input type="hidden" name="contact[tags]" value="newsletter">
              <div class="newsletter-form__field-wrapper">
                <div class="field">
                  <input
                    id="NewsletterForm--{{ section.id }}"
                    type="email"
                    name="contact[email]"
                    class="field__input"
                    value="{{ form.email }}"
                    aria-required="true"
                    autocorrect="off"
                    autocapitalize="off"
                    autocomplete="email"
                    {% if form.errors %}
                      autofocus aria-invalid="true" aria-describedby="ContactFooter-error"
                    {% elsif form.posted_successfully? %}
                      aria-describedby="ContactFooter-success"
                    {% endif %}
                    placeholder="{{ 'newsletter.label' | t }}"
                    required
                  >
                  <label class="field__label" for="NewsletterForm--{{ section.id }}">
                    {{ 'newsletter.label' | t }}
                  </label>
                  <button
                    type="submit"
                    class="newsletter-form__button field__button"
                    name="commit"
                    id="Subscribe"
                    aria-label="{{ 'newsletter.button_label' | t }}"
                  >
                    <span class="svg-wrapper">{{ 'icon-arrow.svg' | inline_asset_content }}</span>
                  </button>
                </div>

                {%- if form.errors -%}
                  <small class="newsletter-form__message form__message" id="ContactFooter-error">
                    <span class="svg-wrapper">{{ 'icon-error.svg' | inline_asset_content }}</span>
                    {{- form.errors.translated_fields.email | capitalize }} {{ form.errors.messages.email -}}
                  </small>
                {%- endif -%}
              </div>

              {%- if form.posted_successfully? -%}
                <h3 class="newsletter-form__message newsletter-form__message--success form__message" id="ContactFooter-success" tabindex="-1" autofocus>
                  <span class="svg-wrapper">{{ 'icon-success.svg' | inline_asset_content }}</span>
                  {{ 'newsletter.success' | t }}
                </h3>
              {%- endif -%}
            {%- endform -%}
          {%- endif -%}

          {%- liquid
            assign has_social_icons = true
            if settings.social_facebook_link == blank and settings.social_instagram_link == blank and settings.social_youtube_link == blank and settings.social_tiktok_link == blank and settings.social_twitter_link == blank and settings.social_pinterest_link == blank and settings.social_snapchat_link == blank and settings.social_tumblr_link == blank and settings.social_vimeo_link == blank
              assign has_social_icons = false
            endif
          -%}
          {%- if section.settings.show_social and has_social_icons -%}
            {%- render 'social-icons', class: 'footer__list-social' -%}
          {%- endif -%}
        </div>

        <!-- Optional brand/info block area (shows first brand block automatically if present) -->
        <div>
          {%- assign brand_block = section.blocks | where: 'type', 'brand_information' | first -%}
          {%- if brand_block -%}
            <div class="footer-block__brand-info">
              {%- if settings.brand_image != blank -%}
                {%- assign brand_image_height = settings.brand_image_width | divided_by: settings.brand_image.aspect_ratio -%}
                <div class="footer-block__image-wrapper" style="max-width: min(100%, {{ settings.brand_image_width }}px);">
                  {{ settings.brand_image | image_url: width: 1100 | image_tag: loading: 'lazy', widths: '200, 300, 400, 550, 800, 1100', height: brand_image_height, width: settings.brand_image_width }}
                </div>
              {%- endif -%}
              {%- if settings.brand_headline != blank -%}
                <h3 class="footer-block__heading rte" style="margin-top:10px">{{ settings.brand_headline }}</h3>
              {%- endif -%}
              {%- if settings.brand_description != blank -%}
                <div class="rte" style="color:var(--footer-muted)">{{ settings.brand_description }}</div>
              {%- endif -%}
            </div>
          {%- endif -%}
        </div>
      </div>
    </div>

    <!-- Content Blocks: Link lists, text, images (collapsible on mobile) -->
    {%- if section.blocks.size > 0 -%}
      {%- liquid
        if section.blocks.size == 9
          assign footer_grid_class = 'grid--3-col-tablet'
        elsif section.blocks.size > 6
          assign footer_grid_class = 'grid--4-col-desktop'
        elsif section.blocks.size > 4
          assign footer_grid_class = 'grid--3-col-tablet'
        endif
      -%}
      <div class="footer__content-top">
        <div class="footer__blocks-wrapper {{ footer_grid_class }}">
          {%- for block in section.blocks -%}
            <div class="footer-block grid__item" {{ block.shopify_attributes }}>
              {%- case block.type -%}
                {%- when '@app' -%}
                  {% render block %}

                {%- when 'link_list' -%}
                  {%- if block.settings.menu != blank -%}
                    <details class="ft-accordion" {% if request.design_mode %}open{% endif %}>
                      <summary class="footer-block__heading inline-richtext">
                        {{- block.settings.heading | default: block.settings.menu.title -}}
                        <svg class="ft-caret" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                      </summary>
                      <ul class="footer-block__details-content list-unstyled">
                        {%- for link in block.settings.menu.links -%}
                          <li>
                            <a href="{{ link.url }}" class="link link--text list-menu__item list-menu__item--link{% if link.active %} list-menu__item--active{% endif %}">
                              {{ link.title | escape }}
                            </a>
                          </li>
                        {%- endfor -%}
                      </ul>
                    </details>
                  {%- endif -%}

                {%- when 'text' -%}
                  <details class="ft-accordion" {% if request.design_mode %}open{% endif %}>
                    <summary class="footer-block__heading inline-richtext">
                      {{- block.settings.heading -}}
                      <svg class="ft-caret" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </summary>
                    <div class="footer-block__details-content rte">
                      {{ block.settings.subtext }}
                    </div>
                  </details>

                {%- when 'brand_information' -%}
                  <!-- Already surfaced above if present; keep here for editor parity -->
                  <details class="ft-accordion" {% if request.design_mode %}open{% endif %}>
                    <summary class="footer-block__heading inline-richtext">
                      {{- block.settings.heading | default: 'About' -}}
                      <svg class="ft-caret" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </summary>
                    <div class="footer-block__details-content">
                      {%- if settings.brand_headline != blank -%}
                        <div class="rte" style="margin:.2rem 0 0">{{ settings.brand_headline }}</div>
                      {%- endif -%}
                      {%- if settings.brand_description != blank -%}
                        <div class="rte" style="color:var(--footer-muted)">{{ settings.brand_description }}</div>
                      {%- endif -%}
                    </div>
                  </details>

                {%- when 'image' -%}
                  <details class="ft-accordion" {% if request.design_mode %}open{% endif %}>
                    <summary class="footer-block__heading inline-richtext">
                      {{ block.settings.heading | default: 'Gallery' }}
                      <svg class="ft-caret" width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9l6 6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
                    </summary>
                    <div class="footer-block__details-content footer-block-image {{ block.settings.alignment }}">
                      {%- if block.settings.image != blank -%}
                        {%- assign image_size_2x = block.settings.image_width | times: 2 | at_most: 5760 -%}
                        <div class="footer-block__image-wrapper" style="max-width: min(100%, {{ block.settings.image_width }}px);">
                          <img
                            srcset="{{ block.settings.image | image_url: width: block.settings.image_width }}, {{ block.settings.image | image_url: width: image_size_2x }} 2x"
                            src="{{ block.settings.image | image_url: width: 760 }}"
                            alt="{{ block.settings.image.alt | escape }}"
                            loading="lazy"
                            width="{{ block.settings.image.width }}"
                            height="{{ block.settings.image.height }}"
                          >
                        </div>
                      {%- else -%}
                        {{ 'image' | placeholder_svg_tag: 'placeholder-svg placeholder' }}
                      {%- endif -%}
                    </div>
                  </details>
              {%- endcase -%}
            </div>
          {%- endfor -%}
        </div>
      </div>
    {%- endif -%}

    <!-- Bottom utilities -->
    <div class="footer__content-bottom">
      <div class="footer__content-bottom-wrapper page-width">
        <div class="footer__column footer__localization isolate">
          {%- if section.settings.enable_country_selector and localization.available_countries.size > 1 -%}
            <localization-form>
              {%- form 'localization', id: 'FooterCountryForm', class: 'localization-form' -%}
                <div>
                  <h2 class="caption-large text-body" id="FooterCountryLabel">{{ 'localization.country_label' | t }}</h2>
                  {%- render 'country-localization', localPosition: 'FooterCountry' -%}
                </div>
              {%- endform -%}
            </localization-form>
          {%- endif -%}

          {%- if section.settings.enable_language_selector and localization.available_languages.size > 1 -%}
            <localization-form>
              {%- form 'localization', id: 'FooterLanguageForm', class: 'localization-form' -%}
                <div>
                  <h2 class="caption-large text-body" id="FooterLanguageLabel">{{ 'localization.language_label' | t }}</h2>
                  {%- render 'language-localization', localPosition: 'FooterLanguage' -%}
                </div>
              {%- endform -%}
            </localization-form>
          {%- endif -%}
        </div>

        <div class="footer__column footer__column--info">
          {%- if section.settings.payment_enable -%}
            <div class="footer__payment">
              <span class="visually-hidden">{{ 'sections.footer.payment' | t }}</span>
              <ul class="list list-payment" role="list">
                {%- for type in shop.enabled_payment_types -%}
                  <li class="list-payment__item">{{ type | payment_type_svg_tag: class: 'icon icon--full-color' }}</li>
                {%- endfor -%}
              </ul>
            </div>
          {%- endif -%}
        </div>
      </div>

      <div class="footer__content-bottom-wrapper page-width{% if section.settings.enable_country_selector == false and section.settings.enable_language_selector == false %} footer__content-bottom-wrapper--center{% endif %}">
        <div class="footer__copyright caption">
          <small class="copyright__content">&copy; {{ 'now' | date: '%Y' }}, {{ shop.name | link_to: routes.root_url }}</small>
          <small class="copyright__content">{{ powered_by_link }}</small>
          {%- if section.settings.show_policy -%}
            <ul class="policies list-unstyled">
              {%- for policy in shop.policies -%}
                {%- if policy != blank -%}
                  <li><small class="copyright__content"><a href="{{ policy.url }}">{{ policy.title | escape }}</a></small></li>
                {%- endif -%}
              {%- endfor -%}
            </ul>
          {%- endif -%}
        </div>
      </div>
    </div>
  </div>

  <!-- Back to top -->
  <button class="ft-backtop" id="ftBackTop" aria-label="Back to top" title="Back to top">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 5l-7 7h4v7h6v-7h4L12 5z" fill="currentColor"/></svg>
  </button>
</footer>

<script>
  // Back to top visibility + smooth scroll
  (function(){
    const btn = document.getElementById('ftBackTop');
    const toggle = () => {
      if (window.scrollY > 400) btn.classList.add('show');
      else btn.classList.remove('show');
    };
    window.addEventListener('scroll', toggle, {passive:true});
    toggle();
    btn.addEventListener('click', () => window.scrollTo({top:0, behavior:'smooth'}));
  })();
</script>

{% schema %}
{
  "name": "t:sections.footer.name",
  "blocks": [
    { "type": "@app" },
    {
      "type": "link_list",
      "name": "t:sections.footer.blocks.link_list.name",
      "settings": [
        { "type": "inline_richtext", "id": "heading", "default": "Links", "label": "Heading" },
        { "type": "link_list", "id": "menu", "default": "footer", "label": "Menu" }
      ]
    },
    {
      "type": "brand_information",
      "name": "t:sections.footer.blocks.brand_information.name",
      "settings": [
        { "type": "paragraph", "content": "Use theme settings (Brand) to add logo, headline and description." },
        { "type": "checkbox", "id": "show_social", "default": true, "label": "Show social icons" }
      ]
    },
    {
      "type": "text",
      "name": "t:sections.footer.blocks.text.name",
      "settings": [
        { "type": "inline_richtext", "id": "heading", "default": "About us", "label": "Heading" },
        { "type": "richtext", "id": "subtext", "default": "<p>Write a short description, promos, or store details here.</p>", "label": "Text" }
      ]
    },
    {
      "type": "image",
      "name": "Image",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Image" },
        { "type": "range", "id": "image_width", "min": 50, "max": 550, "step": 5, "unit": "px", "label": "Width", "default": 220 },
        {
          "type": "select", "id": "alignment", "label": "Alignment",
          "options":[ { "value":"","label":"Left" }, { "value":"center","label":"Center" }, { "value":"right","label":"Right" } ],
          "default":"center"
        }
      ]
    }
  ],
  "settings": [
    { "type": "color_scheme", "id": "color_scheme", "label": "t:sections.all.colors.label", "default": "scheme-1" },

    { "type": "header", "content": "Newsletter" },
    { "type": "checkbox", "id": "newsletter_enable", "default": true, "label": "Enable newsletter" },
    { "type": "inline_richtext", "id": "newsletter_heading", "default": "Stay in the loop", "label": "Newsletter heading" },

    { "type": "header", "content": "Social & Follow" },
    { "type": "checkbox", "id": "enable_follow_on_shop", "default": false, "label": "Enable Follow on Shop" },
    { "type": "checkbox", "id": "show_social", "default": true, "label": "Show social icons" },

    { "type": "header", "content": "Localization & Payments" },
    { "type": "checkbox", "id": "enable_country_selector", "default": true, "label": "Enable country selector" },
    { "type": "checkbox", "id": "enable_language_selector", "default": true, "label": "Enable language selector" },
    { "type": "checkbox", "id": "payment_enable", "default": true, "label": "Show payment icons" },
    { "type": "checkbox", "id": "show_policy", "default": true, "label": "Show policy links" },

    { "type": "header", "content": "Spacing" },
    { "type": "range", "id": "margin_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Margin top", "default": 0 },
    { "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding top", "default": 36 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Padding bottom", "default": 36 }
  ],
  "default": {
    "blocks": [
      { "type": "link_list" },
      { "type": "text" }
    ]
  }
}
{% endschema %}
